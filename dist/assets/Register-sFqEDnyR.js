import{r as m,l as B,z as _,B as d,R as s,L as x,J as a,al as u,aB as E,A as v,O as w}from"./vendor-DdeEpjzh.js";import{a as M}from"./index-ID-G45V4.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as U,E as p}from"./element-DkRX-ly5.js";const F={class:"register-container"},N={class:"register-form-wrapper"},z={class:"button-container"},A={key:0,class:"error-message"},L={key:1,class:"success-message"},T={__name:"Register",setup(I){const g=m(null),r=B({username:"",name:"",password:"",confirmPassword:"",phone:""}),y={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度应在3-20个字符之间",trigger:"blur"}],name:[{required:!0,message:"请输入真实姓名",trigger:"blur"},{min:2,max:20,message:"姓名长度应在2-20个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"},{pattern:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/,message:"密码必须包含字母和数字",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(b,e,o)=>{e!==r.password?o(new Error("两次输入的密码不一致")):o()},trigger:"blur"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码格式",trigger:"blur"}]},t=m(!1),c=m(""),f=m(""),V=E(),k=async()=>{g.value.validate(async b=>{if(b){const e=U.service({lock:!0,text:"注册中...",background:"rgba(0, 0, 0, 0.7)"});try{const o={username:r.username,password:r.password,name:r.name,phone:r.phone},l=await M.user.register(o);if(l&&l.code===1)p.success("注册成功！即将跳转到登录页面"),setTimeout(()=>{V.push("/login")},1500);else{const i=l?.msg||l?.message||"注册失败，请重试";p.error("注册失败："+i)}}catch(o){if(console.error("注册请求失败:",o),o.response&&o.response.data){const l=o.response.data.msg||o.response.data.message||"注册失败，请重试";p.error("注册失败："+l)}else p.error("网络错误，请稍后重试")}finally{setTimeout(()=>{e.close()},300),t.value=!1}}})},R=()=>{g.value.resetFields(),c.value="",f.value=""},C=()=>{V.push("/login")};return(b,e)=>{const o=u("el-input"),l=u("el-form-item"),i=u("el-button"),q=u("el-form"),h=u("el-alert");return v(),_("div",F,[d("div",N,[e[8]||(e[8]=d("div",{class:"register-header"},[d("h2",null,"老年人健康服务平台"),d("p",null,"用户注册")],-1)),s(q,{model:r,rules:y,ref_key:"registerFormRef",ref:g,class:"register-form"},{default:a(()=>[s(l,{label:"用户名",prop:"username",class:"register-form-item"},{default:a(()=>[s(o,{modelValue:r.username,"onUpdate:modelValue":e[0]||(e[0]=n=>r.username=n),placeholder:"请输入用户名（登录账号）","prefix-icon":"el-icon-user",disabled:t.value},null,8,["modelValue","disabled"])]),_:1}),s(l,{label:"姓名",prop:"name",class:"register-form-item"},{default:a(()=>[s(o,{modelValue:r.name,"onUpdate:modelValue":e[1]||(e[1]=n=>r.name=n),placeholder:"请输入您的真实姓名","prefix-icon":"el-icon-user-solid",disabled:t.value},null,8,["modelValue","disabled"])]),_:1}),s(l,{label:"密码",prop:"password",class:"register-form-item"},{default:a(()=>[s(o,{modelValue:r.password,"onUpdate:modelValue":e[2]||(e[2]=n=>r.password=n),type:"password",placeholder:"请设置密码（至少6位）","prefix-icon":"el-icon-lock","show-password":"",disabled:t.value},null,8,["modelValue","disabled"])]),_:1}),s(l,{label:"确认密码",prop:"confirmPassword",class:"register-form-item"},{default:a(()=>[s(o,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=n=>r.confirmPassword=n),type:"password",placeholder:"请再次输入密码","prefix-icon":"el-icon-lock","show-password":"",disabled:t.value},null,8,["modelValue","disabled"])]),_:1}),s(l,{label:"手机号",prop:"phone",class:"register-form-item"},{default:a(()=>[s(o,{modelValue:r.phone,"onUpdate:modelValue":e[4]||(e[4]=n=>r.phone=n),placeholder:"请输入手机号码","prefix-icon":"el-icon-phone",disabled:t.value},null,8,["modelValue","disabled"])]),_:1}),s(l,{class:"register-form-item register-button-group"},{default:a(()=>[d("div",z,[s(i,{type:"primary",onClick:k,loading:t.value,class:"register-btn"},{default:a(()=>[...e[5]||(e[5]=[w(" 注册 ",-1)])]),_:1},8,["loading"]),s(i,{onClick:R,disabled:t.value,class:"reset-btn"},{default:a(()=>[...e[6]||(e[6]=[w(" 重置 ",-1)])]),_:1},8,["disabled"])])]),_:1}),s(l,{class:"register-form-item"},{default:a(()=>[s(i,{type:"text",onClick:C,disabled:t.value},{default:a(()=>[...e[7]||(e[7]=[w(" 已有账号？立即登录 ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"]),c.value?(v(),_("div",A,[s(h,{title:c.value,type:"error","show-icon":"",closable:!1},null,8,["title"])])):x("",!0),f.value?(v(),_("div",L,[s(h,{title:f.value,type:"success","show-icon":"",closable:!1},null,8,["title"])])):x("",!0)])])}}},O=P(T,[["__scopeId","data-v-8d4990e2"]]);export{O as default};
