import{r as y,h as R,c as I,z as v,B as o,L as F,R as s,J as n,al as m,K,ar as G,I as H,P as d,Q as W,a5 as X,aB as Y,A as p,O as u}from"./vendor-DdeEpjzh.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as i,b as C}from"./element-DkRX-ly5.js";const ee={class:"shopping-cart"},te={class:"cart-header"},oe={class:"cart-content"},ae={key:0,class:"empty-cart"},se={key:1,class:"cart-items"},ne={class:"product-info"},le=["src","alt"],re={class:"product-details"},ce=["onClick"],ie={class:"product-specs"},de={class:"price"},ue={class:"subtotal price"},me={class:"cart-actions"},pe={class:"left-actions"},_e={class:"right-actions"},ge={class:"total-section"},ve={class:"total-price"},he={class:"total-quantity"},fe={class:"checkout-section"},ye={key:0,class:"recommendations"},be={class:"recommend-list"},we=["onClick"],ke={class:"recommend-image"},Ce=["src","alt"],xe={class:"recommend-info"},Be={class:"recommend-name"},Ie={class:"recommend-price"},qe={__name:"ShoppingCart",setup(Se){const b=Y(),w=y(!1),r=y([]),_=y(!1),l=y([]),q=y([{id:3,name:"家用血糖仪套装精准测血糖仪器",price:199,image:"/images/products/blood-sugar.jpg"},{id:5,name:"智能手环心率血压监测运动计步器",price:199,image:"/images/products/fitness-band.jpg"},{id:7,name:"家用制氧机老人氧气机",price:2499,image:"/images/products/oxygen.jpg"},{id:9,name:"医用红外额温枪电子体温计",price:129,image:"/images/products/thermometer.jpg"}]);R(()=>{S()});const S=async()=>{w.value=!0;try{r.value=T()}catch(t){console.error("加载购物车失败",t),i.error("加载购物车失败，请重试")}finally{w.value=!1}},T=()=>[{id:1,productId:1,name:"智能血压计家用上臂式全自动测量仪",image:"/images/products/blood-pressure.jpg",price:299,quantity:1,specs:{颜色:"白色",型号:"BP-3000"},subtotal:299},{id:2,productId:2,name:"家用血糖仪套装精准测血糖仪器",image:"/images/products/blood-sugar.jpg",price:199,quantity:2,specs:{规格:"50试纸",品牌:"健康卫士"},subtotal:398}],V=I(()=>l.value.reduce((t,e)=>t+e.price*e.quantity,0)),j=I(()=>r.value.reduce((t,e)=>t+e.quantity,0)),$=t=>{l.value=t,_.value=t.length===r.value.length&&t.length>0},D=()=>{_.value?l.value=[...r.value]:l.value=[]},P=async t=>{try{t.subtotal=t.price*t.quantity,i.success("已更新商品数量")}catch(e){console.error("更新数量失败",e),i.error("更新失败，请重试");const c=r.value.find(k=>k.id===t.id);c&&(c.quantity=c.oldQuantity||c.quantity)}},M=async t=>{try{await C.confirm("确定要删除该商品吗？","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=r.value.findIndex(c=>c.id===t);e>-1&&r.value.splice(e,1),l.value=l.value.filter(c=>c.id!==t),i.success("删除成功")}catch(e){e!=="cancel"&&(console.error("删除失败",e),i.error("删除失败，请重试"))}},N=async()=>{if(l.value.length===0){i.warning("请选择要删除的商品");return}try{await C.confirm("确定要删除选中的商品吗？","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const t=l.value.map(e=>e.id);r.value=r.value.filter(e=>!t.includes(e.id)),l.value=[],_.value=!1,i.success("批量删除成功")}catch(t){t!=="cancel"&&(console.error("批量删除失败",t),i.error("删除失败，请重试"))}},E=async()=>{try{await C.confirm("确定要清空购物车吗？","确认清空",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),r.value=[],l.value=[],_.value=!1,i.success("购物车已清空")}catch(t){t!=="cancel"&&(console.error("清空购物车失败",t),i.error("操作失败，请重试"))}},Q=()=>{if(l.value.length===0){i.warning("请选择要结算的商品");return}const t={items:l.value.map(e=>({id:e.id,productId:e.productId,quantity:e.quantity}))};sessionStorage.setItem("checkoutParams",JSON.stringify(t)),b.push("/user/mall/checkout")},x=()=>{b.push("/user/mall")},B=t=>{b.push(`/user/mall/product/${t}`)},z=t=>t?Object.entries(t).map(([e,c])=>`${e}: ${c}`).join(", "):"";return(t,e)=>{const c=m("el-breadcrumb-item"),k=m("el-breadcrumb"),h=m("el-button"),A=m("el-empty"),g=m("el-table-column"),O=m("el-input-number"),U=m("el-table"),J=m("el-checkbox"),L=G("loading");return p(),v("div",ee,[o("div",te,[e[3]||(e[3]=o("h2",null,"我的购物车",-1)),s(k,{separator:"/"},{default:n(()=>[s(c,{onClick:x},{default:n(()=>[...e[1]||(e[1]=[u("商城首页",-1)])]),_:1}),s(c,null,{default:n(()=>[...e[2]||(e[2]=[u("购物车",-1)])]),_:1})]),_:1})]),o("div",oe,[r.value.length===0?(p(),v("div",ae,[s(A,{description:"购物车是空的","image-size":200},{description:n(()=>[...e[4]||(e[4]=[u(" 快去选购心仪的商品吧 ",-1)])]),default:n(()=>[s(h,{type:"primary",onClick:x},{default:n(()=>[...e[5]||(e[5]=[u("去购物",-1)])]),_:1})]),_:1})])):(p(),v("div",se,[K((p(),H(U,{data:r.value,style:{width:"100%"},border:"",onSelectionChange:$},{default:n(()=>[s(g,{type:"selection",width:"55"}),s(g,{prop:"name",label:"商品信息","min-width":"300"},{default:n(a=>[o("div",ne,[o("img",{src:a.row.image,alt:a.row.name,class:"product-image"},null,8,le),o("div",re,[o("div",{class:"product-name",onClick:f=>B(a.row.productId)},d(a.row.name),9,ce),o("div",ie,d(z(a.row.specs)),1)])])]),_:1}),s(g,{prop:"price",label:"单价",width:"120",align:"center"},{default:n(a=>[o("span",de,"¥"+d(a.row.price),1)]),_:1}),s(g,{prop:"quantity",label:"数量",width:"180",align:"center"},{default:n(a=>[s(O,{modelValue:a.row.quantity,"onUpdate:modelValue":f=>a.row.quantity=f,min:1,max:99,size:"small",onChange:f=>P(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),s(g,{prop:"subtotal",label:"小计",width:"120",align:"center"},{default:n(a=>[o("span",ue,"¥"+d(a.row.subtotal),1)]),_:1}),s(g,{label:"操作",width:"100",align:"center"},{default:n(a=>[s(h,{type:"text",onClick:f=>M(a.row.id),"confirm-message":"确定要删除该商品吗？"},{default:n(()=>[...e[6]||(e[6]=[u(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,w.value]]),o("div",me,[o("div",pe,[s(J,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=a=>_.value=a),onChange:D},{default:n(()=>[...e[7]||(e[7]=[u("全选",-1)])]),_:1},8,["modelValue"]),s(h,{type:"text",onClick:N,disabled:l.value.length===0},{default:n(()=>[...e[8]||(e[8]=[u(" 批量删除 ",-1)])]),_:1},8,["disabled"]),s(h,{type:"text",onClick:E},{default:n(()=>[...e[9]||(e[9]=[u("清空购物车",-1)])]),_:1})]),o("div",_e,[o("div",ge,[e[10]||(e[10]=o("span",{class:"total-text"},"合计：",-1)),o("span",ve,"¥"+d(V.value),1),o("span",he,"共 "+d(j.value)+" 件商品",1)]),o("div",fe,[s(h,{type:"primary",onClick:Q,disabled:l.value.length===0},{default:n(()=>[u(" 结算 ("+d(l.value.length)+") ",1)]),_:1},8,["disabled"])])])])]))]),r.value.length>0?(p(),v("div",ye,[e[11]||(e[11]=o("h3",null,"猜你喜欢",-1)),o("div",be,[(p(!0),v(W,null,X(q.value,a=>(p(),v("div",{key:a.id,class:"recommend-item",onClick:f=>B(a.id)},[o("div",ke,[o("img",{src:a.image,alt:a.name},null,8,Ce)]),o("div",xe,[o("div",Be,d(a.name),1),o("div",Ie,"¥"+d(a.price),1)])],8,we))),128))])])):F("",!0)])}}},$e=Z(qe,[["__scopeId","data-v-0faf850b"]]);export{$e as default};
